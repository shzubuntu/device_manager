!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e,n){for(var o=0;o<n.length;o++){var r=n[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,t(r.key),r)}}function t(n){var t=function(n){if("object"!=e(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,"string");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==e(t)?t:t+""}document.addEventListener("xterm-ready",(function(){try{var e=window.Terminal,t=window.FitAddon,o=window.WebLinksAddon,r=function(){return r=function n(r){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),this.deviceId=r,console.log("Creating new Terminal instance"),this.terminal=new e({cursorBlink:!0,fontSize:14,fontFamily:"Consolas, monospace",theme:{background:"#1e1e1e",foreground:"#ffffff"}}),console.log("Terminal instance created:",this.terminal),console.log("Terminal.onData exists:","function"==typeof this.terminal.onData),this.fitAddon=new t,this.webLinksAddon=new o,this.terminal.loadAddon(this.fitAddon),this.terminal.loadAddon(this.webLinksAddon),this.socket=null,this.connected=!1},(i=[{key:"init",value:function(e){var n=this;this.terminal.open(document.getElementById(e)),this.fitAddon.fit(),window.addEventListener("resize",(function(){return n.fitAddon.fit()})),this.terminal.onData((function(e){if(n.connected&&n.socket)try{n.socket.send(JSON.stringify({type:"input",data:e}))}catch(e){console.error("Error sending input:",e)}})),this.connect()}},{key:"connect",value:function(){var e=this;this.socket=new WebSocket("ws://".concat(window.location.host,"/ws/ssh/").concat(this.deviceId,"/")),this.socket.onopen=function(){e.connected=!0,e.terminal.writeln("\r\n[32mConnected to device terminal[0m\r\n"),e.socket.send(JSON.stringify({type:"auth",device_id:e.deviceId}))},this.socket.onmessage=function(n){var t=JSON.parse(n.data);switch(t.type){case"output":e.terminal.write(t.data);break;case"status":e.terminal.writeln("\r\n[33m".concat(t.message,"[0m\r\n"));break;case"error":e.terminal.writeln("\r\n[31mError: ".concat(t.message,"[0m\r\n"));break;default:console.warn("Unknown message type:",t.type)}},this.socket.onclose=function(){e.connected=!1,e.terminal.writeln("\r\n[31mConnection closed[0m\r\n")},this.socket.onerror=function(n){e.connected=!1,e.terminal.writeln("\r\n[31mConnection error: ".concat(n.message,"[0m\r\n"))}}},{key:"disconnect",value:function(){this.socket&&this.socket.close()}}])&&n(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i}();document.addEventListener("DOMContentLoaded",(function(){try{console.log("DOMContentLoaded event fired");var e=document.getElementById("terminal");if(!e)throw new Error("Terminal element not found");var n=e.dataset.deviceId;if(!n)throw new Error("Device ID not found");console.log("Creating DeviceTerminal instance for device:",n);var t=new r(n);if(console.log("Initializing terminal..."),t.init("terminal"),console.log("Terminal initialization complete"),!t.terminal||"function"!=typeof t.terminal.on)throw new Error("Terminal instance is not properly initialized")}catch(e){console.error("Error initializing terminal:",e);var o=document.createElement("div");o.style.color="red",o.style.padding="20px",o.textContent="Terminal initialization error: ".concat(e.message),document.body.appendChild(o)}}))}catch(e){console.error("Error in xterm-ready handler:",e)}})),function(){try{var e=document.createElement("link");e.rel="stylesheet",e.href="/static/xterm/xterm.css",e.onerror=function(){return console.error("Failed to load xterm CSS")},document.head.appendChild(e);var n=document.createElement("script");n.src="/static/xterm/xterm.min.js",n.onerror=function(){return console.error("Failed to load xterm.js")},n.onload=function(){try{if(!window.Terminal)throw new Error("Terminal class not found after loading xterm.js");var e=document.createElement("script");e.src="/static/xterm/xterm-addon-fit.min.js",e.onerror=function(){return console.error("Failed to load FitAddon")},e.onload=function(){try{if(!window.FitAddon)throw new Error("FitAddon class not found after loading");var e=document.createElement("script");e.src="/static/xterm/xterm-addon-web-links.min.js",e.onerror=function(){return console.error("Failed to load WebLinksAddon")},e.onload=function(){if(!window.WebLinksAddon)throw new Error("WebLinksAddon class not found after loading");console.log("All xterm resources loaded successfully"),document.dispatchEvent(new Event("xterm-ready"))},document.head.appendChild(e)}catch(e){console.error("Error loading WebLinksAddon:",e)}},document.head.appendChild(e)}catch(e){console.error("Error loading FitAddon:",e)}},document.head.appendChild(n)}catch(e){console.error("Error loading xterm resources:",e)}}()}();
//# sourceMappingURL=terminal.bundle.js.map